{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "4dda099b_2711b0e5",
        "filename": "/COMMIT_MSG",
        "patchSetId": 40
      },
      "lineNbr": 33,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-06-16T17:39:47Z",
      "side": 1,
      "message": "I think the last piece now that you\u0027re working on is to get a Tested: in here to confirm the returned fd can be used to read the dump.",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1b1a26cc_eea86838",
        "filename": "/COMMIT_MSG",
        "patchSetId": 40
      },
      "lineNbr": 33,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-17T08:50:31Z",
      "side": 1,
      "message": "Yes, need to test with PLDM that the dump is offloading to host",
      "parentUuid": "4dda099b_2711b0e5",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "41e6c0d1_de20b88d",
        "filename": "/COMMIT_MSG",
        "patchSetId": 40
      },
      "lineNbr": 33,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-21T11:16:51Z",
      "side": 1,
      "message": "Tested",
      "parentUuid": "1b1a26cc_eea86838",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6e2a7148_4894d661",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 40
      },
      "lineNbr": 0,
      "author": {
        "id": 1001591
      },
      "writtenOn": "2023-06-15T12:15:08Z",
      "side": 1,
      "message": "A query on FD close",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6f59ca3a_5d523ba9",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 40
      },
      "lineNbr": 0,
      "author": {
        "id": 1001591
      },
      "writtenOn": "2023-06-15T12:52:59Z",
      "side": 1,
      "message": "Done",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "07aac8ff_6a8b1ae5",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 40
      },
      "lineNbr": 0,
      "author": {
        "id": 1001591
      },
      "writtenOn": "2023-06-15T12:54:16Z",
      "side": 1,
      "message": "Done from my side with the latest changes. +1",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "ee87dd6e_959aafdb",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 40
      },
      "lineNbr": 0,
      "author": {
        "id": 1000086
      },
      "writtenOn": "2023-06-21T05:57:21Z",
      "side": 1,
      "message": "Looks like this commit is blocking phosphor-dbus-interface version bump. @patrick suggested alternate option to unblock version bump, incase required more time on testing. See discord discussion fro details.",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7de71564_61484e1b",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 40
      },
      "lineNbr": 0,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-21T06:04:44Z",
      "side": 1,
      "message": "https://gerrit.openbmc.org/c/openbmc/phosphor-debug-collector/+/64304",
      "parentUuid": "ee87dd6e_959aafdb",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "f86da764_dea49859",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-06-15T18:33:02Z",
      "side": 1,
      "message": "I\u0027ve done a bit of digging but I don\u0027t understand sdeventplus::source::Defer. Will this automatically be called on our next event loop? If so, how do we ensure we don\u0027t close this file descriptor before the caller is done with it?",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "127c9084_da5504c4",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-16T10:52:20Z",
      "side": 1,
      "message": "I was also digging on that, Jay is making a pldm change to test this\nbut when I am testing with busctl getting a different value than in the actual fd\n\n:~# busctl call  xyz.openbmc_project.Dump.Manager  /xyz/openbmc_project/dump/bmc/entry/1 xyz.openbmc_project.Dump.Entry GetFileHandle\n\u003c6\u003e file handle request \u003c- A debug trace\n\u003c6\u003e Request file: /var/lib/phosphor-debug-collector/dumps/1/BMCDUMP.13BE990.0000001.20230616083932 \u003c- Requested for this file\n\u003c3\u003e Value 11 \u003c-- fd value in the server\nh 4 \u003c-- fd value retuned\n:~# \u003c6\u003e File closed file: /var/lib/phosphor-debug-collector/dumps/1/BMCDUMP.13BE990.0000001.20230616083932 fd: 11\n\nso there is a mismatch in this number, I may have to ask around",
      "parentUuid": "f86da764_dea49859",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2b5d9d3f_894f012a",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2023-06-16T14:02:02Z",
      "side": 1,
      "message": "I think I get it now. When we pass the fd back to the caller, it\u0027s duplicated. So as soon as we are sure they have the new duplicated fd, we close ours using this Defer callback. They can then close their copy of the fd whenever they are done with it. Tricky stuff.",
      "parentUuid": "127c9084_da5504c4",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6c201014_5e26d4e5",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000086
      },
      "writtenOn": "2023-06-19T09:44:57Z",
      "side": 1,
      "message": "Should update GetFileHandle d-bus documentation with expected behavior , saying user has to delete this fd after usage.",
      "parentUuid": "2b5d9d3f_894f012a",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e44cce55_30e97de5",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-19T09:50:19Z",
      "side": 1,
      "message": "The dup of this fd is returned to the caller, and this fd is closed here, I couldnt find such a statement in other dbus definitions returning a unix_fd",
      "parentUuid": "6c201014_5e26d4e5",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "2b719e88_e7d88e82",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000086
      },
      "writtenOn": "2023-06-19T10:09:51Z",
      "side": 1,
      "message": "who is responsible for deleting the duplicate fd?",
      "parentUuid": "e44cce55_30e97de5",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "4858784d_b59d8a72",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 57,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-19T10:22:41Z",
      "side": 1,
      "message": "You\u0027re correct that closing the fd returned by the caller is specific to the sdbusplus implementation. It is a general behavior for any interface returning a unix_fd and not specific to this particular interface.\n\nSince this implementation does not perform the duping of the fd and this interface does not specify how the fd should be handled, I don\u0027t believe it is necessary to add generic information about fd deletion to this interface documentation.\n\nHowever, if it is deemed necessary to provide guidance on fd deletion, it would be more appropriate to document it at a higher level",
      "parentUuid": "2b719e88_e7d88e82",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c0edb644_ad86c8f0",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 58,
      "author": {
        "id": 1001591
      },
      "writtenOn": "2023-06-15T12:15:08Z",
      "side": 1,
      "message": "If we are closing the FD on our own and any client try to close it on their side separately then what would be the result? Can we do something like\nconst sdbusplus::message::unix_fd\u0026 Entry::getFileHandle() where we take fd as std::unique_ptr\u003cint\u003e fd; ?",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "78d1fa53_02f55545",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 58,
      "author": {
        "id": 1000084
      },
      "writtenOn": "2023-06-15T12:36:05Z",
      "side": 1,
      "message": "what is the advantage of having std::unique_ptr\u003cint\u003e fd when returning across dbus?\n\nand in the client implementations,  clients dup the fd and close it independently so the fd opened by this function will be closed by this function.",
      "parentUuid": "c0edb644_ad86c8f0",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c996a2cc_9660045d",
        "filename": "dump_entry.cpp",
        "patchSetId": 40
      },
      "lineNbr": 58,
      "author": {
        "id": 1000089
      },
      "writtenOn": "2023-06-15T14:10:09Z",
      "side": 1,
      "message": "this is a D-Bus method cannot return unique_ptr",
      "parentUuid": "78d1fa53_02f55545",
      "revId": "4b6632af3e5f8dc84ff40079623fa734c64fba83",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}